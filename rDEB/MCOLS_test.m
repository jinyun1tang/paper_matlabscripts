close all;
clear all;
%clc;


x=[1.47, 1.50, 1.52, 1.55, 1.57, 1.60, 1.63, 1.65, 1.68, 1.70, 1.73, 1.75,1.78, 1.80, 1.83];
y=[52.21,53.12,54.48,55.84,57.20,58.57,59.93,61.29,63.11,64.47,66.28,68.10,69.92,72.19,74.46];

d1=   [0.210000000000000
   0.200000000000000
   0.080000000000000
   0.030000000000000
   0.020000000000000
   0.060000000000000
   0.040000000000000
   0.010000000000000
   0.070000000000000
   0.040000000000000
   0.050000000000000
   0.170000000000000
   0.100000000000000
   0.070000000000000
   0.020000000000000
   0.030000000000000
   0.010000000000000
                   0
   0.010000000000000
                   0
                   0
   0.010000000000000]';
d2=[   2.020000000000000
   1.510000000000000
   0.560000000000000
   0.330000000000000
   0.420000000000000
   0.430000000000000
   0.320000000000000
   0.340000000000000
   0.670000000000000
   0.590000000000000
   0.970000000000000
   1.330000000000000
   1.740000000000000
   0.460000000000000
   0.320000000000000
   0.740000000000000
   0.610000000000000
   0.400000000000000
   0.640000000000000
   1.370000000000000
   0.630000000000000
   0.710000000000000]';
x=d1;
y=d2;
nel=numel(x);
p0=polyfit(x,y,1);
f0 = polyval(p0,x);
ysd=std(f0-y);
xsd=std(x);
ns=10000;
ps=zeros(ns,2);
xn=randn(nel,ns);
yn=randn(nel,ns);
for jj = 1 : ns
    xx=x+xsd.*xn(:,jj)';
    f = polyval(p0,xx);
    yy=f+ysd.*yn(:,jj)';
    p=polyfit(xx,yy,1);
    ps(jj,:)=p;
end
fprintf('monte slp: %f,%f,%f\n',mean(ps(:,1)),prctile(ps(:,1),[2.5,97.5]));
fprintf('monte int: %f,%f,%f\n',mean(ps(:,2)),prctile(ps(:,2),[2.5,97.5]));

subplot(1,2,1);histogram(ps(:,1));subplot(1,2,2);histogram(ps(:,2));

w=linearfit(x,y,0.05);
fprintf('ols slp: %f,%f,%f\n',w(1),w(1)-w(2),w(1)+w(2));
fprintf('ols int: %f,%f,%f\n',w(3),w(3)-w(4),w(3)+w(4));
